<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 12 Model Verification (SWATdoctR) | OPTAIN CS10: Kråkstad SWAT+ Modelling Workflow</title>
  <meta name="description" content="A documentation of the project setup for OPTAIN case study 10, Kråkstad" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 12 Model Verification (SWATdoctR) | OPTAIN CS10: Kråkstad SWAT+ Modelling Workflow" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://moritzshore.github.io/optain-cs10/figures/banner.png" />
  <meta property="og:description" content="A documentation of the project setup for OPTAIN case study 10, Kråkstad" />
  <meta name="github-repo" content="moritzshore/optain-cs10" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 12 Model Verification (SWATdoctR) | OPTAIN CS10: Kråkstad SWAT+ Modelling Workflow" />
  
  <meta name="twitter:description" content="A documentation of the project setup for OPTAIN case study 10, Kråkstad" />
  <meta name="twitter:image" content="https://moritzshore.github.io/optain-cs10/figures/banner.png" />

<meta name="author" content="Moritz Shore (workflow author, modelling) Csilla Farkas (lead modeller) Christoph Schürz (modelling) Doninika Krzeminska (measures &amp; stakeholders) Anne-Grete Buseth Blankenberg (measures &amp; stakeholders) Robert Barneveld (measures &amp; mapping) Attila Nemes (project lead) ..and with strong support of the OPTAIN core team" />


<meta name="date" content="2025-02-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="management-swatfarmr.html"/>
<link rel="next" href="soft-calibration.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<script src="libs/tile1_rasterlayer_4608e7-1/data_stars_tile1_rasterlayer82613c.txt"></script>
<script src="libs/joda-0.0.1/joda.js"></script>
<script src="libs/joda-0.0.1/addImageQuery-bindings.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />
<script src="libs/tile2_rasterlayer_d0b7c6-1/data_stars_tile2_rasterlayer18d403.txt"></script>
<script src="libs/dem_layer_915ecb-1/data_stars_dem_layer92e3a7.txt"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<script src="libs/stream_crop_39b072-1/data_stars_stream_crop2d4f69.txt"></script>
<script src="libs/ws_a1945d-1/data_stars_ws4efda1.txt"></script>
<script src="libs/rglWebGL-binding-1.3.17/rglWebGL.js"></script>
<link href="libs/rglwidgetClass-1.3.17/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-1.3.17/rglClass.src.js"></script>
<script src="libs/rglwidgetClass-1.3.17/utils.src.js"></script>
<script src="libs/rglwidgetClass-1.3.17/buffer.src.js"></script>
<script src="libs/rglwidgetClass-1.3.17/subscenes.src.js"></script>
<script src="libs/rglwidgetClass-1.3.17/shaders.src.js"></script>
<script src="libs/rglwidgetClass-1.3.17/shadersrc.src.js"></script>
<script src="libs/rglwidgetClass-1.3.17/textures.src.js"></script>
<script src="libs/rglwidgetClass-1.3.17/projection.src.js"></script>
<script src="libs/rglwidgetClass-1.3.17/mouse.src.js"></script>
<script src="libs/rglwidgetClass-1.3.17/init.src.js"></script>
<script src="libs/rglwidgetClass-1.3.17/pieces.src.js"></script>
<script src="libs/rglwidgetClass-1.3.17/draw.src.js"></script>
<script src="libs/rglwidgetClass-1.3.17/controls.src.js"></script>
<script src="libs/rglwidgetClass-1.3.17/selection.src.js"></script>
<script src="libs/rglwidgetClass-1.3.17/rglTimer.src.js"></script>
<script src="libs/rglwidgetClass-1.3.17/pretty.src.js"></script>
<script src="libs/rglwidgetClass-1.3.17/axes.src.js"></script>
<script src="libs/rglwidgetClass-1.3.17/animation.src.js"></script>
<script src="libs/CanvasMatrix4-1.3.17/CanvasMatrix.src.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="libs/dt-ext-scroller-1.13.6/css/scroller.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-scroller-1.13.6/js/dataTables.scroller.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">The OPTAIN-CS10 Project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="input-data-preparation.html"><a href="input-data-preparation.html"><i class="fa fa-check"></i><b>1</b> Input Data Preparation</a>
<ul>
<li class="chapter" data-level="1.1" data-path="input-data-preparation.html"><a href="input-data-preparation.html#digital-elevation-model"><i class="fa fa-check"></i><b>1.1</b> Digital Elevation Model</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="input-data-preparation.html"><a href="input-data-preparation.html#high-resolution-dem"><i class="fa fa-check"></i><b>1.1.1</b> High resolution DEM</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="input-data-preparation.html"><a href="input-data-preparation.html#soil-data"><i class="fa fa-check"></i><b>1.2</b> Soil Data</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="input-data-preparation.html"><a href="input-data-preparation.html#high-resolution-soil-maps"><i class="fa fa-check"></i><b>1.2.1</b> High resolution soil maps</a></li>
<li class="chapter" data-level="1.2.2" data-path="input-data-preparation.html"><a href="input-data-preparation.html#data-source"><i class="fa fa-check"></i><b>1.2.2</b> Data source</a></li>
<li class="chapter" data-level="1.2.3" data-path="input-data-preparation.html"><a href="input-data-preparation.html#combining-jordsmonn-and-loesmasser"><i class="fa fa-check"></i><b>1.2.3</b> Combining Jordsmonn and Loesmasser</a></li>
<li class="chapter" data-level="1.2.4" data-path="input-data-preparation.html"><a href="input-data-preparation.html#detailed-soil-map"><i class="fa fa-check"></i><b>1.2.4</b> Detailed Soil Map</a></li>
<li class="chapter" data-level="1.2.5" data-path="input-data-preparation.html"><a href="input-data-preparation.html#reclassification"><i class="fa fa-check"></i><b>1.2.5</b> Reclassification</a></li>
<li class="chapter" data-level="1.2.6" data-path="input-data-preparation.html"><a href="input-data-preparation.html#simplifying-geometries"><i class="fa fa-check"></i><b>1.2.6</b> Simplifying Geometries</a></li>
<li class="chapter" data-level="1.2.7" data-path="input-data-preparation.html"><a href="input-data-preparation.html#writing-vector-layer"><i class="fa fa-check"></i><b>1.2.7</b> Writing vector layer</a></li>
<li class="chapter" data-level="1.2.8" data-path="input-data-preparation.html"><a href="input-data-preparation.html#lookup-table"><i class="fa fa-check"></i><b>1.2.8</b> Lookup Table</a></li>
<li class="chapter" data-level="1.2.9" data-path="input-data-preparation.html"><a href="input-data-preparation.html#rasterization"><i class="fa fa-check"></i><b>1.2.9</b> Rasterization</a></li>
<li class="chapter" data-level="1.2.10" data-path="input-data-preparation.html"><a href="input-data-preparation.html#usersoil"><i class="fa fa-check"></i><b>1.2.10</b> Usersoil</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="input-data-preparation.html"><a href="input-data-preparation.html#watershed-boundary"><i class="fa fa-check"></i><b>1.3</b> Watershed Boundary</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="input-data-preparation.html"><a href="input-data-preparation.html#hydrological-preperation"><i class="fa fa-check"></i><b>1.3.1</b> Hydrological preperation</a></li>
<li class="chapter" data-level="1.3.2" data-path="input-data-preparation.html"><a href="input-data-preparation.html#pour-points"><i class="fa fa-check"></i><b>1.3.2</b> Pour Points</a></li>
<li class="chapter" data-level="1.3.3" data-path="input-data-preparation.html"><a href="input-data-preparation.html#streams"><i class="fa fa-check"></i><b>1.3.3</b> Streams</a></li>
<li class="chapter" data-level="1.3.4" data-path="input-data-preparation.html"><a href="input-data-preparation.html#watershed-delineation"><i class="fa fa-check"></i><b>1.3.4</b> Watershed Delineation</a></li>
<li class="chapter" data-level="1.3.5" data-path="input-data-preparation.html"><a href="input-data-preparation.html#bonus-section"><i class="fa fa-check"></i><b>1.3.5</b> Bonus Section</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="input-data-preparation.html"><a href="input-data-preparation.html#land-object-input"><i class="fa fa-check"></i><b>1.4</b> Land object input</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="input-data-preparation.html"><a href="input-data-preparation.html#data-sources"><i class="fa fa-check"></i><b>1.4.1</b> Data sources</a></li>
<li class="chapter" data-level="1.4.2" data-path="input-data-preparation.html"><a href="input-data-preparation.html#delineation-of-land-objects"><i class="fa fa-check"></i><b>1.4.2</b> Delineation of land objects</a></li>
<li class="chapter" data-level="1.4.3" data-path="input-data-preparation.html"><a href="input-data-preparation.html#standing-water-bodies-and-the-landuse-type-watr"><i class="fa fa-check"></i><b>1.4.3</b> Standing water bodies and the landuse type = ‘watr’</a></li>
<li class="chapter" data-level="1.4.4" data-path="input-data-preparation.html"><a href="input-data-preparation.html#tile-drainage-option"><i class="fa fa-check"></i><b>1.4.4</b> Tile drainage option</a></li>
<li class="chapter" data-level="1.4.5" data-path="input-data-preparation.html"><a href="input-data-preparation.html#existing-and-potential-structures-to-retain-water-and-nutrients"><i class="fa fa-check"></i><b>1.4.5</b> Existing and potential structures to retain water and nutrients</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="input-data-preparation.html"><a href="input-data-preparation.html#channel-object-input"><i class="fa fa-check"></i><b>1.5</b> Channel object input</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="input-data-preparation.html"><a href="input-data-preparation.html#data-sources-and-data-processing"><i class="fa fa-check"></i><b>1.5.1</b> Data sources and data processing</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="input-data-preparation.html"><a href="input-data-preparation.html#point-sources-locations"><i class="fa fa-check"></i><b>1.6</b> Point sources locations</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="input-data-preparation.html"><a href="input-data-preparation.html#point-source-source-data"><i class="fa fa-check"></i><b>1.6.1</b> Point source source data</a></li>
<li class="chapter" data-level="1.6.2" data-path="input-data-preparation.html"><a href="input-data-preparation.html#point-source-data-files"><i class="fa fa-check"></i><b>1.6.2</b> Point source data files</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="input-data-preparation.html"><a href="input-data-preparation.html#aquifer-objects"><i class="fa fa-check"></i><b>1.7</b> Aquifer Objects</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html"><i class="fa fa-check"></i><b>2</b> Model Setup (SWATbuildR)</a>
<ul>
<li class="chapter" data-level="2.1" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html#buildr-setup"><i class="fa fa-check"></i><b>2.1</b> BuildR Setup</a></li>
<li class="chapter" data-level="2.2" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html#processing-input-data"><i class="fa fa-check"></i><b>2.2</b> Processing input data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html#high-resolution-digital-elevation-model-dem"><i class="fa fa-check"></i><b>2.2.1</b> High-Resolution Digital Elevation Model (DEM)</a></li>
<li class="chapter" data-level="2.2.2" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html#processing-the-basin-boundary"><i class="fa fa-check"></i><b>2.2.2</b> Processing the Basin Boundary</a></li>
<li class="chapter" data-level="2.2.3" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html#processing-the-land-layer"><i class="fa fa-check"></i><b>2.2.3</b> Processing the Land layer</a></li>
<li class="chapter" data-level="2.2.4" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html#processing-the-channels"><i class="fa fa-check"></i><b>2.2.4</b> Processing the Channels</a></li>
<li class="chapter" data-level="2.2.5" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html#processing-the-dem"><i class="fa fa-check"></i><b>2.2.5</b> Processing the DEM</a></li>
<li class="chapter" data-level="2.2.6" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html#processing-soil-data"><i class="fa fa-check"></i><b>2.2.6</b> Processing Soil Data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html#calculating-cocoa"><i class="fa fa-check"></i><b>2.3</b> Calculating COCOA</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html#calculating-land-unit-connectivity"><i class="fa fa-check"></i><b>2.3.1</b> Calculating land unit connectivity</a></li>
<li class="chapter" data-level="2.3.2" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html#calculating-channelreservoir-connectivity"><i class="fa fa-check"></i><b>2.3.2</b> Calculating channel/reservoir connectivity</a></li>
<li class="chapter" data-level="2.3.3" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html#checking-the-water-objects-for-infinite-loops"><i class="fa fa-check"></i><b>2.3.3</b> Checking the water objects for infinite loops</a></li>
<li class="chapter" data-level="2.3.4" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html#terrain-properties"><i class="fa fa-check"></i><b>2.3.4</b> Terrain properties</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html#generate-swat-input"><i class="fa fa-check"></i><b>2.4</b> Generate SWAT+ input</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html#generate-land-object-swat-input-tables"><i class="fa fa-check"></i><b>2.4.1</b> Generate land object SWAT+ input tables</a></li>
<li class="chapter" data-level="2.4.2" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html#generate-water-object-swat-input-tables"><i class="fa fa-check"></i><b>2.4.2</b> Generate water object SWAT+ input tables</a></li>
<li class="chapter" data-level="2.4.3" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html#build-aquifer-input"><i class="fa fa-check"></i><b>2.4.3</b> Build aquifer input</a></li>
<li class="chapter" data-level="2.4.4" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html#add-point-source-inputs"><i class="fa fa-check"></i><b>2.4.4</b> Add point source inputs</a></li>
<li class="chapter" data-level="2.4.5" data-path="model-setup-swatbuildr.html"><a href="model-setup-swatbuildr.html#create-swat-sqlite-database"><i class="fa fa-check"></i><b>2.4.5</b> Create SWAT+ sqlite database</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="weather-input.html"><a href="weather-input.html"><i class="fa fa-check"></i><b>3</b> Weather Input</a>
<ul>
<li class="chapter" data-level="3.1" data-path="weather-input.html"><a href="weather-input.html#loading-data"><i class="fa fa-check"></i><b>3.1</b> Loading Data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="weather-input.html"><a href="weather-input.html#required-packages"><i class="fa fa-check"></i><b>3.1.1</b> Required packages</a></li>
<li class="chapter" data-level="3.1.2" data-path="weather-input.html"><a href="weather-input.html#load-in-the-files-and-load-svatools-template"><i class="fa fa-check"></i><b>3.1.2</b> Load in the file(s) and load svatools template</a></li>
<li class="chapter" data-level="3.1.3" data-path="weather-input.html"><a href="weather-input.html#proof-the-station"><i class="fa fa-check"></i><b>3.1.3</b> Proof the station</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="weather-input.html"><a href="weather-input.html#weather-generator"><i class="fa fa-check"></i><b>3.2</b> Weather Generator</a></li>
<li class="chapter" data-level="3.3" data-path="weather-input.html"><a href="weather-input.html#adding-data-to-swat"><i class="fa fa-check"></i><b>3.3</b> Adding data to SWAT+</a></li>
<li class="chapter" data-level="3.4" data-path="weather-input.html"><a href="weather-input.html#atmospheric-deposition"><i class="fa fa-check"></i><b>3.4</b> Atmospheric Deposition</a></li>
<li class="chapter" data-level="3.5" data-path="weather-input.html"><a href="weather-input.html#re-analysis-weather"><i class="fa fa-check"></i><b>3.5</b> Re-analysis Weather</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="writing-input-files.html"><a href="writing-input-files.html"><i class="fa fa-check"></i><b>4</b> Writing Input Files</a>
<ul>
<li class="chapter" data-level="4.1" data-path="writing-input-files.html"><a href="writing-input-files.html#via-python"><i class="fa fa-check"></i><b>4.1</b> Via Python</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="writing-input-files.html"><a href="writing-input-files.html#swat-test-run"><i class="fa fa-check"></i><b>4.1.1</b> SWAT+ Test Run</a></li>
<li class="chapter" data-level="4.1.2" data-path="writing-input-files.html"><a href="writing-input-files.html#link-aquifers-and-channels-with-geomorphic-flow"><i class="fa fa-check"></i><b>4.1.2</b> Link aquifers and channels with geomorphic flow</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="writing-input-files.html"><a href="writing-input-files.html#via-swat-editor"><i class="fa fa-check"></i><b>4.2</b> Via SWAT Editor</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="writing-input-files.html"><a href="writing-input-files.html#loading-the-project-in-swat-editor"><i class="fa fa-check"></i><b>4.2.1</b> Loading the project in SWAT+ Editor</a></li>
<li class="chapter" data-level="4.2.2" data-path="writing-input-files.html"><a href="writing-input-files.html#writing-input-files-1"><i class="fa fa-check"></i><b>4.2.2</b> Writing input files</a></li>
<li class="chapter" data-level="4.2.3" data-path="writing-input-files.html"><a href="writing-input-files.html#post-write-changes"><i class="fa fa-check"></i><b>4.2.3</b> Post-write Changes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="crop-map.html"><a href="crop-map.html"><i class="fa fa-check"></i><b>5</b> Crop Map</a>
<ul>
<li class="chapter" data-level="5.1" data-path="crop-map.html"><a href="crop-map.html#calculating-field-area"><i class="fa fa-check"></i><b>5.1</b> Calculating Field Area</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="crop-map.html"><a href="crop-map.html#calculate-field-area-and-assign-ids"><i class="fa fa-check"></i><b>5.1.1</b> Calculate Field Area and Assign IDs</a></li>
<li class="chapter" data-level="5.1.2" data-path="crop-map.html"><a href="crop-map.html#calculate-field-area-and-assign-ids-1"><i class="fa fa-check"></i><b>5.1.2</b> Calculate Field area and assign IDs</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="crop-map.html"><a href="crop-map.html#generating-the-crop-rotation"><i class="fa fa-check"></i><b>5.2</b> Generating the Crop Rotation</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="crop-map.html"><a href="crop-map.html#tidy-up-the-source-data"><i class="fa fa-check"></i><b>5.2.1</b> Tidy up the source data:</a></li>
<li class="chapter" data-level="5.2.2" data-path="crop-map.html"><a href="crop-map.html#tidy-up-the-buildr-output"><i class="fa fa-check"></i><b>5.2.2</b> Tidy up the BuildR output</a></li>
<li class="chapter" data-level="5.2.3" data-path="crop-map.html"><a href="crop-map.html#field-classification"><i class="fa fa-check"></i><b>5.2.3</b> Field classification</a></li>
<li class="chapter" data-level="5.2.4" data-path="crop-map.html"><a href="crop-map.html#extrapolating-the-crop-rotation"><i class="fa fa-check"></i><b>5.2.4</b> Extrapolating the Crop Rotation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="crop-map.html"><a href="crop-map.html#merging-with-swatbuildr"><i class="fa fa-check"></i><b>5.3</b> Merging with SWATbuildR</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="landuse-parameterization.html"><a href="landuse-parameterization.html"><i class="fa fa-check"></i><b>6</b> Landuse Parameterization</a>
<ul>
<li class="chapter" data-level="6.1" data-path="landuse-parameterization.html"><a href="landuse-parameterization.html#data-preperation"><i class="fa fa-check"></i><b>6.1</b> Data preperation</a></li>
<li class="chapter" data-level="6.2" data-path="landuse-parameterization.html"><a href="landuse-parameterization.html#assigning-landuse-values"><i class="fa fa-check"></i><b>6.2</b> Assigning landuse values</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="landuse-parameterization.html"><a href="landuse-parameterization.html#setting-cal_group"><i class="fa fa-check"></i><b>6.2.1</b> Setting <code>cal_group</code></a></li>
<li class="chapter" data-level="6.2.2" data-path="landuse-parameterization.html"><a href="landuse-parameterization.html#setting-plnt_com"><i class="fa fa-check"></i><b>6.2.2</b> Setting <code>plnt_com</code></a></li>
<li class="chapter" data-level="6.2.3" data-path="landuse-parameterization.html"><a href="landuse-parameterization.html#setting-mgt"><i class="fa fa-check"></i><b>6.2.3</b> Setting <code>mgt</code></a></li>
<li class="chapter" data-level="6.2.4" data-path="landuse-parameterization.html"><a href="landuse-parameterization.html#setting-urb_ro"><i class="fa fa-check"></i><b>6.2.4</b> Setting <code>urb_ro</code></a></li>
<li class="chapter" data-level="6.2.5" data-path="landuse-parameterization.html"><a href="landuse-parameterization.html#setting-urban"><i class="fa fa-check"></i><b>6.2.5</b> Setting <code>urban</code></a></li>
<li class="chapter" data-level="6.2.6" data-path="landuse-parameterization.html"><a href="landuse-parameterization.html#setting-mannings-n-ovn"><i class="fa fa-check"></i><b>6.2.6</b> Setting Manning’s n (<code>ovn</code>)</a></li>
<li class="chapter" data-level="6.2.7" data-path="landuse-parameterization.html"><a href="landuse-parameterization.html#setting-cn2"><i class="fa fa-check"></i><b>6.2.7</b> Setting <code>cn2</code>:</a></li>
<li class="chapter" data-level="6.2.8" data-path="landuse-parameterization.html"><a href="landuse-parameterization.html#setting-cons_prac"><i class="fa fa-check"></i><b>6.2.8</b> Setting <code>cons_prac</code></a></li>
<li class="chapter" data-level="6.2.9" data-path="landuse-parameterization.html"><a href="landuse-parameterization.html#setting-tile"><i class="fa fa-check"></i><b>6.2.9</b> Setting <code>tile</code></a></li>
<li class="chapter" data-level="6.2.10" data-path="landuse-parameterization.html"><a href="landuse-parameterization.html#setting-sep"><i class="fa fa-check"></i><b>6.2.10</b> Setting <code>sep</code></a></li>
<li class="chapter" data-level="6.2.11" data-path="landuse-parameterization.html"><a href="landuse-parameterization.html#setting-vfs"><i class="fa fa-check"></i><b>6.2.11</b> Setting <code>vfs</code></a></li>
<li class="chapter" data-level="6.2.12" data-path="landuse-parameterization.html"><a href="landuse-parameterization.html#setting-grww"><i class="fa fa-check"></i><b>6.2.12</b> Setting <code>grww</code></a></li>
<li class="chapter" data-level="6.2.13" data-path="landuse-parameterization.html"><a href="landuse-parameterization.html#setting-bmp"><i class="fa fa-check"></i><b>6.2.13</b> Setting <code>bmp</code></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="landuse-parameterization.html"><a href="landuse-parameterization.html#writing-changes"><i class="fa fa-check"></i><b>6.3</b> Writing Changes</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="field-site-loggers.html"><a href="field-site-loggers.html"><i class="fa fa-check"></i><b>7</b> Field Site Loggers</a>
<ul>
<li class="chapter" data-level="7.1" data-path="field-site-loggers.html"><a href="field-site-loggers.html#introduction-1"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="field-site-loggers.html"><a href="field-site-loggers.html#prerequisites"><i class="fa fa-check"></i><b>7.1.1</b> Prerequisites</a></li>
<li class="chapter" data-level="7.1.2" data-path="field-site-loggers.html"><a href="field-site-loggers.html#locations"><i class="fa fa-check"></i><b>7.1.2</b> Locations</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="field-site-loggers.html"><a href="field-site-loggers.html#data-processing"><i class="fa fa-check"></i><b>7.2</b> Data Processing</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="field-site-loggers.html"><a href="field-site-loggers.html#loading-data-1"><i class="fa fa-check"></i><b>7.2.1</b> Loading Data</a></li>
<li class="chapter" data-level="7.2.2" data-path="field-site-loggers.html"><a href="field-site-loggers.html#data-re-structuring"><i class="fa fa-check"></i><b>7.2.2</b> Data Re-structuring</a></li>
<li class="chapter" data-level="7.2.3" data-path="field-site-loggers.html"><a href="field-site-loggers.html#summarize-to-daily-means"><i class="fa fa-check"></i><b>7.2.3</b> Summarize to Daily Means</a></li>
<li class="chapter" data-level="7.2.4" data-path="field-site-loggers.html"><a href="field-site-loggers.html#including-air-temperature-and-precipitation-data"><i class="fa fa-check"></i><b>7.2.4</b> Including Air Temperature and Precipitation Data</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="field-site-loggers.html"><a href="field-site-loggers.html#data-quality-check"><i class="fa fa-check"></i><b>7.3</b> Data quality check</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="field-site-loggers.html"><a href="field-site-loggers.html#logger-600409-deep-rocky-sand"><i class="fa fa-check"></i><b>7.3.1</b> Logger 600409 “Deep Rocky Sand”</a></li>
<li class="chapter" data-level="7.3.2" data-path="field-site-loggers.html"><a href="field-site-loggers.html#logger-600410-tormods-farm"><i class="fa fa-check"></i><b>7.3.2</b> Logger 600410 “Tormods farm”</a></li>
<li class="chapter" data-level="7.3.3" data-path="field-site-loggers.html"><a href="field-site-loggers.html#logger-600411-john-ivar-lower-area"><i class="fa fa-check"></i><b>7.3.3</b> Logger 600411 “John Ivar Lower Area”</a></li>
<li class="chapter" data-level="7.3.4" data-path="field-site-loggers.html"><a href="field-site-loggers.html#logger-600413-john-ivar-behind-the-barn"><i class="fa fa-check"></i><b>7.3.4</b> Logger 600413 “John Ivar behind the barn”</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="field-site-loggers.html"><a href="field-site-loggers.html#data-cleanup"><i class="fa fa-check"></i><b>7.4</b> Data Cleanup</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="field-site-loggers.html"><a href="field-site-loggers.html#general-cleanup"><i class="fa fa-check"></i><b>7.4.1</b> General cleanup</a></li>
<li class="chapter" data-level="7.4.2" data-path="field-site-loggers.html"><a href="field-site-loggers.html#logger-specific-cleanup"><i class="fa fa-check"></i><b>7.4.2</b> Logger specific cleanup</a></li>
<li class="chapter" data-level="7.4.3" data-path="field-site-loggers.html"><a href="field-site-loggers.html#saving-the-cleaned-data"><i class="fa fa-check"></i><b>7.4.3</b> Saving the cleaned data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="field-site-properties.html"><a href="field-site-properties.html"><i class="fa fa-check"></i><b>8</b> Field Site Properties</a>
<ul>
<li class="chapter" data-level="8.1" data-path="field-site-properties.html"><a href="field-site-properties.html#determining-hsg"><i class="fa fa-check"></i><b>8.1</b> Determining HSG</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="antecedent-precipitation-index.html"><a href="antecedent-precipitation-index.html"><i class="fa fa-check"></i><b>9</b> Antecedent Precipitation Index</a>
<ul>
<li class="chapter" data-level="9.1" data-path="antecedent-precipitation-index.html"><a href="antecedent-precipitation-index.html#introduction-2"><i class="fa fa-check"></i><b>9.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="antecedent-precipitation-index.html"><a href="antecedent-precipitation-index.html#pre-requirements"><i class="fa fa-check"></i><b>9.1.1</b> Pre-requirements</a></li>
<li class="chapter" data-level="9.1.2" data-path="antecedent-precipitation-index.html"><a href="antecedent-precipitation-index.html#setting-up-python-for-rrmarkdown"><i class="fa fa-check"></i><b>9.1.2</b> Setting up Python for R/Rmarkdown</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="antecedent-precipitation-index.html"><a href="antecedent-precipitation-index.html#antecedent-precipitation-index-1"><i class="fa fa-check"></i><b>9.2</b> Antecedent Precipitation Index</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="antecedent-precipitation-index.html"><a href="antecedent-precipitation-index.html#loading-data-2"><i class="fa fa-check"></i><b>9.2.1</b> Loading data</a></li>
<li class="chapter" data-level="9.2.2" data-path="antecedent-precipitation-index.html"><a href="antecedent-precipitation-index.html#calculating-the-total-water-content"><i class="fa fa-check"></i><b>9.2.2</b> Calculating the total water content</a></li>
<li class="chapter" data-level="9.2.3" data-path="antecedent-precipitation-index.html"><a href="antecedent-precipitation-index.html#defining-api-model"><i class="fa fa-check"></i><b>9.2.3</b> Defining API model</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="antecedent-precipitation-index.html"><a href="antecedent-precipitation-index.html#conclusions"><i class="fa fa-check"></i><b>9.3</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-parameterization.html"><a href="model-parameterization.html"><i class="fa fa-check"></i><b>10</b> Model Parameterization</a>
<ul>
<li class="chapter" data-level="10.1" data-path="model-parameterization.html"><a href="model-parameterization.html#parameter-changes"><i class="fa fa-check"></i><b>10.1</b> Parameter Changes</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="model-parameterization.html"><a href="model-parameterization.html#channel-parameters-revised"><i class="fa fa-check"></i><b>10.1.1</b> Channel parameters revised</a></li>
<li class="chapter" data-level="10.1.2" data-path="model-parameterization.html"><a href="model-parameterization.html#crop-parameters-verified"><i class="fa fa-check"></i><b>10.1.2</b> Crop parameters verified</a></li>
<li class="chapter" data-level="10.1.3" data-path="model-parameterization.html"><a href="model-parameterization.html#soil-physical-parameters-in-final-form"><i class="fa fa-check"></i><b>10.1.3</b> Soil physical parameters in final form</a></li>
<li class="chapter" data-level="10.1.4" data-path="model-parameterization.html"><a href="model-parameterization.html#soil-chemical-parameters-in-final-form"><i class="fa fa-check"></i><b>10.1.4</b> Soil chemical parameters in final form</a></li>
<li class="chapter" data-level="10.1.5" data-path="model-parameterization.html"><a href="model-parameterization.html#impoundment-parameters-defined"><i class="fa fa-check"></i><b>10.1.5</b> Impoundment parameters defined</a></li>
<li class="chapter" data-level="10.1.6" data-path="model-parameterization.html"><a href="model-parameterization.html#water-diversions-defined"><i class="fa fa-check"></i><b>10.1.6</b> Water diversions defined</a></li>
<li class="chapter" data-level="10.1.7" data-path="model-parameterization.html"><a href="model-parameterization.html#point-sources-parameters-added"><i class="fa fa-check"></i><b>10.1.7</b> Point sources parameters added</a></li>
<li class="chapter" data-level="10.1.8" data-path="model-parameterization.html"><a href="model-parameterization.html#tile-drainage-parameters-defined"><i class="fa fa-check"></i><b>10.1.8</b> Tile drainage parameters defined</a></li>
<li class="chapter" data-level="10.1.9" data-path="model-parameterization.html"><a href="model-parameterization.html#atmospheric-deposition-defined"><i class="fa fa-check"></i><b>10.1.9</b> Atmospheric deposition defined</a></li>
<li class="chapter" data-level="10.1.10" data-path="model-parameterization.html"><a href="model-parameterization.html#additional-settings-verified"><i class="fa fa-check"></i><b>10.1.10</b> Additional settings verified</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="model-parameterization.html"><a href="model-parameterization.html#fixing-tiledrain"><i class="fa fa-check"></i><b>10.2</b> Fixing tiledrain</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="model-parameterization.html"><a href="model-parameterization.html#finding-the-problem-hrus"><i class="fa fa-check"></i><b>10.2.1</b> Finding the problem HRUs</a></li>
<li class="chapter" data-level="10.2.2" data-path="model-parameterization.html"><a href="model-parameterization.html#fixing-the-problem-hrus"><i class="fa fa-check"></i><b>10.2.2</b> Fixing the problem HRUs</a></li>
<li class="chapter" data-level="10.2.3" data-path="model-parameterization.html"><a href="model-parameterization.html#checking-changes"><i class="fa fa-check"></i><b>10.2.3</b> Checking changes</a></li>
<li class="chapter" data-level="10.2.4" data-path="model-parameterization.html"><a href="model-parameterization.html#writing-modified-changes"><i class="fa fa-check"></i><b>10.2.4</b> Writing modified changes</a></li>
<li class="chapter" data-level="10.2.5" data-path="model-parameterization.html"><a href="model-parameterization.html#re-enabling-tiledrain"><i class="fa fa-check"></i><b>10.2.5</b> Re-enabling tiledrain</a></li>
<li class="chapter" data-level="10.2.6" data-path="model-parameterization.html"><a href="model-parameterization.html#testing-swat"><i class="fa fa-check"></i><b>10.2.6</b> Testing SWAT+</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-parameterization.html"><a href="model-parameterization.html#soil-phosphorous"><i class="fa fa-check"></i><b>10.3</b> Soil Phosphorous</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="management-swatfarmr.html"><a href="management-swatfarmr.html"><i class="fa fa-check"></i><b>11</b> Management (SWATfarmR)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="management-swatfarmr.html"><a href="management-swatfarmr.html#pre-processing-crop-rotation"><i class="fa fa-check"></i><b>11.1</b> Pre-processing crop rotation</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="management-swatfarmr.html"><a href="management-swatfarmr.html#input-files"><i class="fa fa-check"></i><b>11.1.1</b> Input files</a></li>
<li class="chapter" data-level="11.1.2" data-path="management-swatfarmr.html"><a href="management-swatfarmr.html#settings"><i class="fa fa-check"></i><b>11.1.2</b> Settings</a></li>
<li class="chapter" data-level="11.1.3" data-path="management-swatfarmr.html"><a href="management-swatfarmr.html#checks"><i class="fa fa-check"></i><b>11.1.3</b> Checks</a></li>
<li class="chapter" data-level="11.1.4" data-path="management-swatfarmr.html"><a href="management-swatfarmr.html#writing-input-data"><i class="fa fa-check"></i><b>11.1.4</b> Writing input data</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="management-swatfarmr.html"><a href="management-swatfarmr.html#initializing-farmr"><i class="fa fa-check"></i><b>11.2</b> Initializing FarmR</a></li>
<li class="chapter" data-level="11.3" data-path="management-swatfarmr.html"><a href="management-swatfarmr.html#calculating-api"><i class="fa fa-check"></i><b>11.3</b> Calculating API</a></li>
<li class="chapter" data-level="11.4" data-path="management-swatfarmr.html"><a href="management-swatfarmr.html#scheduling-operations"><i class="fa fa-check"></i><b>11.4</b> Scheduling Operations</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="management-swatfarmr.html"><a href="management-swatfarmr.html#write-operations"><i class="fa fa-check"></i><b>11.4.1</b> Write Operations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="model-verification-swatdoctr.html"><a href="model-verification-swatdoctr.html"><i class="fa fa-check"></i><b>12</b> Model Verification (SWATdoctR)</a>
<ul>
<li class="chapter" data-level="12.1" data-path="model-verification-swatdoctr.html"><a href="model-verification-swatdoctr.html#climate-variables"><i class="fa fa-check"></i><b>12.1</b> Climate Variables</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="model-verification-swatdoctr.html"><a href="model-verification-swatdoctr.html#lapse-rate"><i class="fa fa-check"></i><b>12.1.1</b> Lapse rate</a></li>
<li class="chapter" data-level="12.1.2" data-path="model-verification-swatdoctr.html"><a href="model-verification-swatdoctr.html#climate-variables-1"><i class="fa fa-check"></i><b>12.1.2</b> Climate variables</a></li>
<li class="chapter" data-level="12.1.3" data-path="model-verification-swatdoctr.html"><a href="model-verification-swatdoctr.html#snowfall-and-snowmelt"><i class="fa fa-check"></i><b>12.1.3</b> Snowfall and Snowmelt</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="model-verification-swatdoctr.html"><a href="model-verification-swatdoctr.html#management-operations"><i class="fa fa-check"></i><b>12.2</b> Management operations</a></li>
<li class="chapter" data-level="12.3" data-path="model-verification-swatdoctr.html"><a href="model-verification-swatdoctr.html#unconstrained-plant-growth"><i class="fa fa-check"></i><b>12.3</b> Unconstrained plant growth</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="soft-calibration.html"><a href="soft-calibration.html"><i class="fa fa-check"></i><b>13</b> Soft Calibration</a></li>
<li class="chapter" data-level="14" data-path="hard-calibration.html"><a href="hard-calibration.html"><i class="fa fa-check"></i><b>14</b> Hard Calibration</a></li>
<li class="chapter" data-level="15" data-path="landuse-scenarios.html"><a href="landuse-scenarios.html"><i class="fa fa-check"></i><b>15</b> Landuse Scenarios</a>
<ul>
<li class="chapter" data-level="15.1" data-path="landuse-scenarios.html"><a href="landuse-scenarios.html#scenarios"><i class="fa fa-check"></i><b>15.1</b> Scenarios</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="landuse-scenarios.html"><a href="landuse-scenarios.html#status-quo"><i class="fa fa-check"></i><b>15.1.1</b> Status Quo</a></li>
<li class="chapter" data-level="15.1.2" data-path="landuse-scenarios.html"><a href="landuse-scenarios.html#no-autumn-tillage"><i class="fa fa-check"></i><b>15.1.2</b> No Autumn Tillage</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="update-of-the-swatfarmr-input-input-files.html"><a href="update-of-the-swatfarmr-input-input-files.html"><i class="fa fa-check"></i><b>16</b> Update of the SWATfarmR input input files</a>
<ul>
<li class="chapter" data-level="16.1" data-path="update-of-the-swatfarmr-input-input-files.html"><a href="update-of-the-swatfarmr-input-input-files.html#setup"><i class="fa fa-check"></i><b>16.1</b> Setup</a></li>
<li class="chapter" data-level="16.2" data-path="update-of-the-swatfarmr-input-input-files.html"><a href="update-of-the-swatfarmr-input-input-files.html#documenting-changes-in-the-txt-inputs-files-of-calibrated-model-setup"><i class="fa fa-check"></i><b>16.2</b> Documenting changes in the txt inputs files of calibrated model setup</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="update-of-the-swatfarmr-input-input-files.html"><a href="update-of-the-swatfarmr-input-input-files.html#preparation-of-swatfarmr-management-input-files"><i class="fa fa-check"></i><b>16.2.1</b> Preparation of <code>SWATfarmR</code> management input files</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="climate-scenarios.html"><a href="climate-scenarios.html"><i class="fa fa-check"></i><b>17</b> Climate Scenarios</a>
<ul>
<li class="chapter" data-level="17.1" data-path="climate-scenarios.html"><a href="climate-scenarios.html#introduction-3"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="climate-scenarios.html"><a href="climate-scenarios.html#setup-1"><i class="fa fa-check"></i><b>17.2</b> Setup</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="climate-scenarios.html"><a href="climate-scenarios.html#re-calculating-management"><i class="fa fa-check"></i><b>17.2.1</b> Re-Calculating Management</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="climate-scenarios.html"><a href="climate-scenarios.html#executing-model"><i class="fa fa-check"></i><b>17.3</b> Executing model</a></li>
<li class="chapter" data-level="17.4" data-path="climate-scenarios.html"><a href="climate-scenarios.html#processing-results"><i class="fa fa-check"></i><b>17.4</b> Processing Results</a></li>
<li class="chapter" data-level="17.5" data-path="climate-scenarios.html"><a href="climate-scenarios.html#output-analysis"><i class="fa fa-check"></i><b>17.5</b> Output Analysis</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="climate-scenarios.html"><a href="climate-scenarios.html#saving-rds"><i class="fa fa-check"></i><b>17.5.1</b> Saving RDS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="measures-swatmeasr.html"><a href="measures-swatmeasr.html"><i class="fa fa-check"></i><b>18</b> Measures (SWATmeasR)</a></li>
<li class="chapter" data-level="19" data-path="measure-implementation.html"><a href="measure-implementation.html"><i class="fa fa-check"></i><b>19</b> Measure Implementation</a></li>
<li class="chapter" data-level="20" data-path="measure-scenarios.html"><a href="measure-scenarios.html"><i class="fa fa-check"></i><b>20</b> Measure Scenarios</a></li>
<li class="chapter" data-level="21" data-path="measure-classification.html"><a href="measure-classification.html"><i class="fa fa-check"></i><b>21</b> Measure Classification</a>
<ul>
<li class="chapter" data-level="21.1" data-path="measure-classification.html"><a href="measure-classification.html#introduction-4"><i class="fa fa-check"></i><b>21.1</b> Introduction</a></li>
<li class="chapter" data-level="21.2" data-path="measure-classification.html"><a href="measure-classification.html#determining-classification"><i class="fa fa-check"></i><b>21.2</b> Determining Classification</a></li>
<li class="chapter" data-level="21.3" data-path="measure-classification.html"><a href="measure-classification.html#applying-classification"><i class="fa fa-check"></i><b>21.3</b> Applying Classification</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="measure-classification.html"><a href="measure-classification.html#gullies-grassed-water-ways"><i class="fa fa-check"></i><b>21.3.1</b> Gullies (grassed water ways)</a></li>
<li class="chapter" data-level="21.3.2" data-path="measure-classification.html"><a href="measure-classification.html#buffer-strips"><i class="fa fa-check"></i><b>21.3.2</b> Buffer Strips</a></li>
<li class="chapter" data-level="21.3.3" data-path="measure-classification.html"><a href="measure-classification.html#ponds"><i class="fa fa-check"></i><b>21.3.3</b> Ponds</a></li>
<li class="chapter" data-level="21.3.4" data-path="measure-classification.html"><a href="measure-classification.html#notill-management-measure"><i class="fa fa-check"></i><b>21.3.4</b> NoTill (management measure)</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="measure-classification.html"><a href="measure-classification.html#hru-scenario-table"><i class="fa fa-check"></i><b>21.4</b> HRU Scenario Table</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="measure-classification.html"><a href="measure-classification.html#merging-into-landuse-map"><i class="fa fa-check"></i><b>21.4.1</b> Merging into Landuse Map</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="optimization.html"><a href="optimization.html"><i class="fa fa-check"></i><b>22</b> Optimization</a>
<ul>
<li class="chapter" data-level="22.1" data-path="optimization.html"><a href="optimization.html#introduction-5"><i class="fa fa-check"></i><b>22.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="optimization.html"><a href="optimization.html#comola"><i class="fa fa-check"></i><b>22.1.1</b> CoMOLA</a></li>
<li class="chapter" data-level="22.1.2" data-path="optimization.html"><a href="optimization.html#the-pareto-frontier"><i class="fa fa-check"></i><b>22.1.2</b> The Pareto Frontier</a></li>
<li class="chapter" data-level="22.1.3" data-path="optimization.html"><a href="optimization.html#nsga-ii"><i class="fa fa-check"></i><b>22.1.3</b> NSGA-II</a></li>
<li class="chapter" data-level="22.1.4" data-path="optimization.html"><a href="optimization.html#the-objective-space"><i class="fa fa-check"></i><b>22.1.4</b> The Objective Space</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="optimization.html"><a href="optimization.html#measure-implementation-1"><i class="fa fa-check"></i><b>22.2</b> Measure Implementation</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="optimization.html"><a href="optimization.html#swatmeasr-project-setup"><i class="fa fa-check"></i><b>22.2.1</b> SWATmeasR project setup</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="optimization.html"><a href="optimization.html#economic-model-setup"><i class="fa fa-check"></i><b>22.3</b> Economic Model Setup</a></li>
<li class="chapter" data-level="22.4" data-path="optimization.html"><a href="optimization.html#comola-setup"><i class="fa fa-check"></i><b>22.4</b> CoMOLA Setup</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="optimization.html"><a href="optimization.html#python-installation"><i class="fa fa-check"></i><b>22.4.1</b> Python Installation</a></li>
<li class="chapter" data-level="22.4.2" data-path="optimization.html"><a href="optimization.html#comola-files"><i class="fa fa-check"></i><b>22.4.2</b> CoMOLA Files</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="optimization.html"><a href="optimization.html#running-comola"><i class="fa fa-check"></i><b>22.5</b> Running CoMOLA</a></li>
<li class="chapter" data-level="22.6" data-path="optimization.html"><a href="optimization.html#results-visualization"><i class="fa fa-check"></i><b>22.6</b> Results Visualization</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="optimization.html"><a href="optimization.html#references"><i class="fa fa-check"></i><b>22.6.1</b> References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="land-object-input-abandoned.html"><a href="land-object-input-abandoned.html"><i class="fa fa-check"></i><b>23</b> Land Object Input (abandoned)</a>
<ul>
<li class="chapter" data-level="23.0.1" data-path="land-object-input-abandoned.html"><a href="land-object-input-abandoned.html#data-sources-1"><i class="fa fa-check"></i><b>23.0.1</b> Data sources</a></li>
<li class="chapter" data-level="23.0.2" data-path="land-object-input-abandoned.html"><a href="land-object-input-abandoned.html#delineation-of-land-objects-1"><i class="fa fa-check"></i><b>23.0.2</b> Delineation of land objects</a></li>
<li class="chapter" data-level="23.0.3" data-path="land-object-input-abandoned.html"><a href="land-object-input-abandoned.html#standing-water-bodies-and-the-land-use-type-watr"><i class="fa fa-check"></i><b>23.0.3</b> Standing water bodies and the land use type = ‘watr’</a></li>
<li class="chapter" data-level="23.0.4" data-path="land-object-input-abandoned.html"><a href="land-object-input-abandoned.html#tile-drainage-option-1"><i class="fa fa-check"></i><b>23.0.4</b> Tile drainage option</a></li>
<li class="chapter" data-level="23.0.5" data-path="land-object-input-abandoned.html"><a href="land-object-input-abandoned.html#ar5"><i class="fa fa-check"></i><b>23.0.5</b> AR5</a></li>
<li class="chapter" data-level="23.0.6" data-path="land-object-input-abandoned.html"><a href="land-object-input-abandoned.html#manual-simplification"><i class="fa fa-check"></i><b>23.0.6</b> Manual Simplification</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="overview-maps.html"><a href="overview-maps.html"><i class="fa fa-check"></i><b>24</b> Overview Maps</a></li>
<li class="chapter" data-level="" data-path="annex.html"><a href="annex.html"><i class="fa fa-check"></i>Annex</a>
<ul>
<li class="chapter" data-level="24.1" data-path="annex.html"><a href="annex.html#packages"><i class="fa fa-check"></i><b>24.1</b> Packages</a></li>
<li class="chapter" data-level="24.2" data-path="annex.html"><a href="annex.html#computer-specs"><i class="fa fa-check"></i><b>24.2</b> Computer Specs</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://www.optain.eu/" target="blank">optain.eu</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">OPTAIN CS10: Kråkstad SWAT+ Modelling Workflow</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="model-verification-swatdoctr" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Section 12</span> Model Verification (SWATdoctR)<a href="model-verification-swatdoctr.html#model-verification-swatdoctr" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>note: this page is still under construction.</p>
</blockquote>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="model-verification-swatdoctr.html#cb507-1" tabindex="-1"></a>RUN_THIS_CHAPTER <span class="ot">=</span> <span class="cn">FALSE</span></span></code></pre></div>
<p><strong>Preparation</strong></p>
<p>Loading required packages, defining paths, and loading objects.</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="model-verification-swatdoctr.html#cb508-1" tabindex="-1"></a><span class="co"># Install/Update SWATdoctR if needed:</span></span>
<span id="cb508-2"><a href="model-verification-swatdoctr.html#cb508-2" tabindex="-1"></a><span class="co"># remotes::install_git(&#39;https://git.ufz.de/schuerz/swatdoctr&#39;, force = FALSE)</span></span>
<span id="cb508-3"><a href="model-verification-swatdoctr.html#cb508-3" tabindex="-1"></a><span class="fu">require</span>(SWATdoctR)</span>
<span id="cb508-4"><a href="model-verification-swatdoctr.html#cb508-4" tabindex="-1"></a><span class="fu">require</span>(DT)</span></code></pre></div>
<p>We copy in our most up to date SWAT input files into our <code>run_swat/</code>
folder where we can modify them and see the changes in the model setup.
<strong>At this point in the project, our most up-to-date files are from our
FarmR setup.</strong> We have set <code>overwrite = FALSE</code> so that no existing
changes will be overwritten. This also means the existing files in
<code>run_swat/</code> will not be overwritten, so make sure to delete any you do
not want anymore.</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="model-verification-swatdoctr.html#cb509-1" tabindex="-1"></a>status <span class="ot">&lt;-</span> <span class="fu">file.copy</span>(</span>
<span id="cb509-2"><a href="model-verification-swatdoctr.html#cb509-2" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">list.files</span>(<span class="st">&quot;model_data/cs10_setup/swat_farmR/&quot;</span>,<span class="at">full.names =</span> T),</span>
<span id="cb509-3"><a href="model-verification-swatdoctr.html#cb509-3" tabindex="-1"></a>  <span class="at">to =</span> <span class="st">&quot;model_data/cs10_setup/run_swat/&quot;</span>,</span>
<span id="cb509-4"><a href="model-verification-swatdoctr.html#cb509-4" tabindex="-1"></a>  <span class="at">overwrite =</span> <span class="cn">TRUE</span>, <span class="co"># change to TRUE if you want to overwrite</span></span>
<span id="cb509-5"><a href="model-verification-swatdoctr.html#cb509-5" tabindex="-1"></a>  <span class="at">recursive =</span> <span class="cn">TRUE</span></span>
<span id="cb509-6"><a href="model-verification-swatdoctr.html#cb509-6" tabindex="-1"></a>)</span>
<span id="cb509-7"><a href="model-verification-swatdoctr.html#cb509-7" tabindex="-1"></a></span>
<span id="cb509-8"><a href="model-verification-swatdoctr.html#cb509-8" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="fu">length</span>(<span class="fu">which</span>(status <span class="sc">==</span> <span class="cn">TRUE</span>)), <span class="st">&quot;files copied out of&quot;</span>, <span class="fu">length</span>(status), <span class="st">&quot;total&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;85 files copied out of 85 total&quot;</code></pre>
<p>We also need our exe in this folder.</p>
<p>We are using the following EXE (feel free to change):</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="model-verification-swatdoctr.html#cb511-1" tabindex="-1"></a>exe <span class="ot">&lt;-</span> <span class="st">&quot;Rev_60_5_6_64rel.exe&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="model-verification-swatdoctr.html#cb512-1" tabindex="-1"></a><span class="fu">file.copy</span>(</span>
<span id="cb512-2"><a href="model-verification-swatdoctr.html#cb512-2" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">paste0</span>(<span class="st">&quot;model_data/cs10_setup/&quot;</span>, exe),</span>
<span id="cb512-3"><a href="model-verification-swatdoctr.html#cb512-3" tabindex="-1"></a>  <span class="at">to =</span> <span class="fu">paste0</span>(<span class="st">&quot;model_data/cs10_setup/run_swat/&quot;</span>, exe), <span class="at">overwrite =</span> T)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>To store any input files we have modified, I have created this directory:</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="model-verification-swatdoctr.html#cb514-1" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">&quot;model_data/cs10_setup/swat_doctr_mod/&quot;</span>, <span class="at">showWarnings =</span> F)</span></code></pre></div>
<p>Place any modified files you want to keep in there, and remeber to copy them into the <code>run_swat/</code> directory when you want to use them in the setup.</p>
<p><strong>Setup modifications</strong></p>
<p>SWATFarmR generates land use labels longer than the max allowed 16
characters. To remedy this we can use the following function</p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="model-verification-swatdoctr.html#cb515-1" tabindex="-1"></a><span class="fu">update_landuse_labels</span>(<span class="st">&quot;model_data/cs10_setup/run_swat/&quot;</span>)</span></code></pre></div>
<p>“Plotting of variables at the harvest and kill of a crop requires that
the management operations ‘harvest’ and ‘kill’ are set separately in the
management schedules and not as a combined ‘harvest_kill’ operation. The
following function fixes the issue.”</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="model-verification-swatdoctr.html#cb516-1" tabindex="-1"></a><span class="fu">add_kill_op</span>(<span class="st">&quot;model_data/cs10_setup/run_swat/&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;No `hvkl` operations exist in &#39;management.sch&#39;. File was not changed.&quot;</code></pre>
<div id="climate-variables" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Climate Variables<a href="model-verification-swatdoctr.html#climate-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We are now ready to start verifying our model setup.</p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="model-verification-swatdoctr.html#cb518-1" tabindex="-1"></a>sim_nostress  <span class="ot">&lt;-</span></span>
<span id="cb518-2"><a href="model-verification-swatdoctr.html#cb518-2" tabindex="-1"></a>  <span class="fu">run_swat_verification</span>(</span>
<span id="cb518-3"><a href="model-verification-swatdoctr.html#cb518-3" tabindex="-1"></a>    <span class="at">project_path =</span> <span class="st">&quot;model_data/cs10_setup/run_swat/&quot;</span>,</span>
<span id="cb518-4"><a href="model-verification-swatdoctr.html#cb518-4" tabindex="-1"></a>    <span class="at">start_date =</span> <span class="st">&quot;2015-01-01&quot;</span>,</span>
<span id="cb518-5"><a href="model-verification-swatdoctr.html#cb518-5" tabindex="-1"></a>    <span class="at">end_date =</span> <span class="st">&quot;2019-12-31&quot;</span>,</span>
<span id="cb518-6"><a href="model-verification-swatdoctr.html#cb518-6" tabindex="-1"></a>    <span class="at">years_skip =</span> <span class="dv">1</span>, <span class="co"># first three years skipped</span></span>
<span id="cb518-7"><a href="model-verification-swatdoctr.html#cb518-7" tabindex="-1"></a>    <span class="at">nostress =</span> <span class="dv">1</span>, <span class="co"># Stress factors OFF @ 1</span></span>
<span id="cb518-8"><a href="model-verification-swatdoctr.html#cb518-8" tabindex="-1"></a>    <span class="at">keep_folder =</span> <span class="cn">TRUE</span>, <span class="co"># .runverify/ folder will NOT be deleted</span></span>
<span id="cb518-9"><a href="model-verification-swatdoctr.html#cb518-9" tabindex="-1"></a>    <span class="at">outputs =</span> <span class="fu">c</span>(<span class="st">&quot;wb&quot;</span>, <span class="st">&quot;mgt&quot;</span>, <span class="st">&quot;plt&quot;</span>) <span class="co"># which things will be in output</span></span>
<span id="cb518-10"><a href="model-verification-swatdoctr.html#cb518-10" tabindex="-1"></a>  )</span></code></pre></div>
<ul>
<li>To include all outputs, set <code>outputs = c("wb", "mgt", "plt")</code></li>
<li>To read more about how this function works, type <code>?run_swat_verification</code> into
the console.</li>
</ul>
<p>We can save this model run like so: (feel free to rename the run)</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="model-verification-swatdoctr.html#cb519-1" tabindex="-1"></a>run_name <span class="ot">=</span> <span class="st">&quot;stage1&quot;</span></span>
<span id="cb519-2"><a href="model-verification-swatdoctr.html#cb519-2" tabindex="-1"></a></span>
<span id="cb519-3"><a href="model-verification-swatdoctr.html#cb519-3" tabindex="-1"></a><span class="fu">saveRDS</span>(sim_nostress,</span>
<span id="cb519-4"><a href="model-verification-swatdoctr.html#cb519-4" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="st">&quot;model_data/cs10_setup/verification_runs/&quot;</span>,</span>
<span id="cb519-5"><a href="model-verification-swatdoctr.html#cb519-5" tabindex="-1"></a>        run_name,</span>
<span id="cb519-6"><a href="model-verification-swatdoctr.html#cb519-6" tabindex="-1"></a>        <span class="st">&quot;.rds&quot;</span>))</span></code></pre></div>
<p>and we can load it like this (so that we don’t need to re-run).</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="model-verification-swatdoctr.html#cb520-1" tabindex="-1"></a>run_name <span class="ot">=</span> <span class="st">&quot;stage1&quot;</span> <span class="co"># change this to which run you want to load. </span></span>
<span id="cb520-2"><a href="model-verification-swatdoctr.html#cb520-2" tabindex="-1"></a></span>
<span id="cb520-3"><a href="model-verification-swatdoctr.html#cb520-3" tabindex="-1"></a>sim_nostress <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(<span class="st">&quot;model_data/cs10_setup/verification_runs/&quot;</span>,</span>
<span id="cb520-4"><a href="model-verification-swatdoctr.html#cb520-4" tabindex="-1"></a>                               run_name, </span>
<span id="cb520-5"><a href="model-verification-swatdoctr.html#cb520-5" tabindex="-1"></a>                               <span class="st">&quot;.rds&quot;</span>))</span></code></pre></div>
<p>Modified from the Protocol:</p>
<ul>
<li>The climate variables daily precipitation and daily minimum/maximum
temperatures are <strong>required</strong> inputs of a SWAT+ model setup (more
info: protocol section 2.4).</li>
</ul>
<blockquote>
<p>We have these present.</p>
</blockquote>
<ul>
<li>Further climate inputs such as solar radiation, relative humidity
and wind speed are <strong>optional</strong> input variables and can be essential
for the calculation of the potential evapotranspiration (PET).</li>
</ul>
<blockquote>
<p>We have these, see issue #42
(<a href="https://gitlab.nibio.no/moritzshore/swat-cs10/-/issues/42">link</a>)</p>
</blockquote>
<ul>
<li>Climate inputs are grouped to weather stations in a model setup and
are assigned to spatial objects (HRUs, channels, reservoirs, etc.)
with the <code>nearest neighbor</code> method.</li>
</ul>
<blockquote>
<p>We only have 1 weather station so this is not of great relevance.</p>
</blockquote>
<ul>
<li>The input of weather data and the assignment of climate variables to
spatial objects can be sources for several issues which must be
analysed:</li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Data structure of the climate input tables, units of the climate
variable, no data flag, etc. was wrong and can result in
unrealistically small or large values of the climate variables in
the simulation.</p>
<blockquote>
<p>Does not seem to be the case in our data</p>
</blockquote></li>
<li><p>The nearest neighbor assignment allocates weather stations to
spatial objects where the weather records do not represent the
actual weather conditions in a spatial object well. This can for
example be an issue in complex terrain.</p>
<blockquote>
<p>Should not be a concern for us (for now) since we only have a
single met station</p>
</blockquote></li>
<li><p>The selected method for the calculation of <strong>PET</strong> results in an
under/overestimation of PET when compared to estimates of PET for
the region. In such cases other methods for the simulation of PET
which are included in SWAT+ should be tested if they better fit the
regional conditions and available weather inputs (see more
<a href="https://gitlab.nibio.no/moritzshore/swat-cs10/-/issues/22">Additional
settings</a>).</p>
<blockquote>
<p>We are having an underestimation of ET from Ecanopy, so it might
be an idea to switch the method See issue
<a href="https://gitlab.nibio.no/moritzshore/swat-cs10/-/issues/62">#62</a></p>
</blockquote></li>
<li><p>Large implausibilities in the weather inputs can be identified in
analyses of annual basin averages of the simulated climate
variables. <strong>Simulated annual and average values of climate
variables must be comparable to observation data and/or region
specific literature values</strong>. Any larger deviations of precipitation
can indicate errors in the input file or an inappropriate assignment
of weather stations to spatial units.</p>
<blockquote>
<p>We have pure observations, so no simulated data.</p>
</blockquote></li>
<li><p>If the lapse rate option is active (Read more in Additional
settings), it may be another potential reason for deviations from
observations.</p>
<blockquote>
<p>We are discussing this topic in issue #39
(<a href="https://gitlab.nibio.no/moritzshore/swat-cs10/-/issues/39">link</a>).
It has been disseminated in Section <a href="model-verification-swatdoctr.html#lapse-rate">12.1.1</a></p>
</blockquote></li>
</ol>
<div id="lapse-rate" class="section level3 hasAnchor" number="12.1.1">
<h3><span class="header-section-number">12.1.1</span> Lapse rate<a href="model-verification-swatdoctr.html#lapse-rate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>From the SWAT+
<a href="https://2468211880-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FT47EY0rpheOA7rIcPNO2%2Fuploads%2F3NHAVo40fD8IfcPs74nV%2FSWATPlus-Rev-Notes-60.5.4.pdf?alt=media&amp;token=48d07703-4b4d-4035-8759-438d82157b05">changelog</a>,
we can see that setting the lapse parameter to 1 allows for adjustment
of temperature and precipitation based off of elevation.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:lapsefiggy"></span>
<img src="figures/lapse.png" alt="Lapse parameter from REVISION 60.5.4 documentation" width="293" />
<p class="caption">
Figure 12.1: Lapse parameter from REVISION 60.5.4 documentation
</p>
</div>
<p>The <code>plaps</code> parameter allows for adjustment of precipitation amounts per
kilometer elevation change. The default is set to 0. The <code>tlaps</code>
parameter allows for adjusting temperature per kilometer elevation, and
it’s default is 6.5C/km.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:tlapsfiggy"></span>
<img src="figures/ptlapse.png" alt="The tlaps and plaps parameters from the REVISION 60.5.4 documentation document" width="317" />
<p class="caption">
Figure 12.2: The tlaps and plaps parameters from the REVISION 60.5.4 documentation document
</p>
</div>
<p>Let us check the elevation differences in our catchment to see if these
parameters could have a meaningful effect.</p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="model-verification-swatdoctr.html#cb521-1" tabindex="-1"></a>dem_path <span class="ot">&lt;-</span> <span class="st">&quot;model_data/cs10_setup/optain-cs10/data/raster/dem.tif&quot;</span></span>
<span id="cb521-2"><a href="model-verification-swatdoctr.html#cb521-2" tabindex="-1"></a></span>
<span id="cb521-3"><a href="model-verification-swatdoctr.html#cb521-3" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb521-4"><a href="model-verification-swatdoctr.html#cb521-4" tabindex="-1"></a>dem_rast <span class="ot">&lt;-</span> <span class="fu">rast</span>(dem_path)</span>
<span id="cb521-5"><a href="model-verification-swatdoctr.html#cb521-5" tabindex="-1"></a></span>
<span id="cb521-6"><a href="model-verification-swatdoctr.html#cb521-6" tabindex="-1"></a><span class="fu">minmax</span>(dem_rast)</span></code></pre></div>
<pre><code>##     dtm3_ns_v5
## min      50.50
## max     251.91</code></pre>
<p>Max elevation change of 200 m is not much, but it could very well have
an effect on snowfall / vs. precipitation. The max temperature
adjustment would be:</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="model-verification-swatdoctr.html#cb523-1" tabindex="-1"></a><span class="fl">6.5</span> <span class="sc">*</span> <span class="fl">0.200</span></span></code></pre></div>
<pre><code>## [1] 1.3</code></pre>
<p>1.3 Degrees Celsius is significant, therefore we will enable <code>tlaps</code> and
keep the default value. 200m does not seem like enough to justify using
the plaps parameter, so we will leave it at 0</p>
<p>And load in <code>codes.bsn</code> and <code>parameters.bsn</code></p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="model-verification-swatdoctr.html#cb525-1" tabindex="-1"></a><span class="do">### Loading parameters</span></span>
<span id="cb525-2"><a href="model-verification-swatdoctr.html#cb525-2" tabindex="-1"></a>codes_path <span class="ot">&lt;-</span> <span class="st">&quot;model_data/cs10_setup/run_swat/codes.bsn&quot;</span></span>
<span id="cb525-3"><a href="model-verification-swatdoctr.html#cb525-3" tabindex="-1"></a>parameters_path <span class="ot">&lt;-</span> <span class="st">&quot;model_data/cs10_setup/run_swat/parameters.bsn&quot;</span></span>
<span id="cb525-4"><a href="model-verification-swatdoctr.html#cb525-4" tabindex="-1"></a></span>
<span id="cb525-5"><a href="model-verification-swatdoctr.html#cb525-5" tabindex="-1"></a>codes_bsn <span class="ot">&lt;-</span></span>
<span id="cb525-6"><a href="model-verification-swatdoctr.html#cb525-6" tabindex="-1"></a>  <span class="fu">read.table</span>(</span>
<span id="cb525-7"><a href="model-verification-swatdoctr.html#cb525-7" tabindex="-1"></a>    <span class="at">file =</span> codes_path,</span>
<span id="cb525-8"><a href="model-verification-swatdoctr.html#cb525-8" tabindex="-1"></a>    <span class="at">skip =</span> <span class="dv">1</span>,</span>
<span id="cb525-9"><a href="model-verification-swatdoctr.html#cb525-9" tabindex="-1"></a>    <span class="at">header =</span> T,</span>
<span id="cb525-10"><a href="model-verification-swatdoctr.html#cb525-10" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb525-11"><a href="model-verification-swatdoctr.html#cb525-11" tabindex="-1"></a>    <span class="at">colClasses =</span> <span class="st">&quot;character&quot;</span></span>
<span id="cb525-12"><a href="model-verification-swatdoctr.html#cb525-12" tabindex="-1"></a>  )</span>
<span id="cb525-13"><a href="model-verification-swatdoctr.html#cb525-13" tabindex="-1"></a>parameters_bsn <span class="ot">&lt;-</span></span>
<span id="cb525-14"><a href="model-verification-swatdoctr.html#cb525-14" tabindex="-1"></a>  <span class="fu">read.table</span>(</span>
<span id="cb525-15"><a href="model-verification-swatdoctr.html#cb525-15" tabindex="-1"></a>    <span class="at">file =</span> parameters_path,</span>
<span id="cb525-16"><a href="model-verification-swatdoctr.html#cb525-16" tabindex="-1"></a>    <span class="at">skip =</span> <span class="dv">1</span>,</span>
<span id="cb525-17"><a href="model-verification-swatdoctr.html#cb525-17" tabindex="-1"></a>    <span class="at">header =</span> T,</span>
<span id="cb525-18"><a href="model-verification-swatdoctr.html#cb525-18" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb525-19"><a href="model-verification-swatdoctr.html#cb525-19" tabindex="-1"></a>    <span class="at">quote =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb525-20"><a href="model-verification-swatdoctr.html#cb525-20" tabindex="-1"></a>    <span class="at">colClasses =</span> <span class="st">&quot;character&quot;</span></span>
<span id="cb525-21"><a href="model-verification-swatdoctr.html#cb525-21" tabindex="-1"></a>  )</span>
<span id="cb525-22"><a href="model-verification-swatdoctr.html#cb525-22" tabindex="-1"></a><span class="do">### Setting parameters</span></span>
<span id="cb525-23"><a href="model-verification-swatdoctr.html#cb525-23" tabindex="-1"></a>codes_bsn<span class="sc">$</span>lapse <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb525-24"><a href="model-verification-swatdoctr.html#cb525-24" tabindex="-1"></a>parameters_bsn<span class="sc">$</span>tlaps <span class="ot">=</span> <span class="fl">6.5</span></span>
<span id="cb525-25"><a href="model-verification-swatdoctr.html#cb525-25" tabindex="-1"></a>parameters_bsn<span class="sc">$</span>plaps <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb525-26"><a href="model-verification-swatdoctr.html#cb525-26" tabindex="-1"></a></span>
<span id="cb525-27"><a href="model-verification-swatdoctr.html#cb525-27" tabindex="-1"></a><span class="do">### Writing Headers</span></span>
<span id="cb525-28"><a href="model-verification-swatdoctr.html#cb525-28" tabindex="-1"></a></span>
<span id="cb525-29"><a href="model-verification-swatdoctr.html#cb525-29" tabindex="-1"></a>write_path <span class="ot">&lt;-</span> <span class="st">&quot;model_data/cs10_setup/swat_doctr_mod/&quot;</span></span>
<span id="cb525-30"><a href="model-verification-swatdoctr.html#cb525-30" tabindex="-1"></a></span>
<span id="cb525-31"><a href="model-verification-swatdoctr.html#cb525-31" tabindex="-1"></a><span class="fu">write.table</span>(</span>
<span id="cb525-32"><a href="model-verification-swatdoctr.html#cb525-32" tabindex="-1"></a>  <span class="st">&quot;codes.bsn header, modified by CS-10 workflow section 11.1&quot;</span>,</span>
<span id="cb525-33"><a href="model-verification-swatdoctr.html#cb525-33" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">paste0</span>(write_path, <span class="st">&quot;codes.bsn&quot;</span>),</span>
<span id="cb525-34"><a href="model-verification-swatdoctr.html#cb525-34" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">&quot;   &quot;</span>,</span>
<span id="cb525-35"><a href="model-verification-swatdoctr.html#cb525-35" tabindex="-1"></a>  <span class="at">row.names =</span> F, </span>
<span id="cb525-36"><a href="model-verification-swatdoctr.html#cb525-36" tabindex="-1"></a>  <span class="at">col.names =</span> F,</span>
<span id="cb525-37"><a href="model-verification-swatdoctr.html#cb525-37" tabindex="-1"></a>  <span class="at">append =</span> F,</span>
<span id="cb525-38"><a href="model-verification-swatdoctr.html#cb525-38" tabindex="-1"></a>  <span class="at">quote =</span> F</span>
<span id="cb525-39"><a href="model-verification-swatdoctr.html#cb525-39" tabindex="-1"></a>)</span>
<span id="cb525-40"><a href="model-verification-swatdoctr.html#cb525-40" tabindex="-1"></a><span class="fu">write.table</span>(</span>
<span id="cb525-41"><a href="model-verification-swatdoctr.html#cb525-41" tabindex="-1"></a>  <span class="st">&quot;parameters.bsn header, modified by CS-10 workflow section 11.1&quot;</span>,</span>
<span id="cb525-42"><a href="model-verification-swatdoctr.html#cb525-42" tabindex="-1"></a>  <span class="at">file =</span>   <span class="fu">paste0</span>(write_path, <span class="st">&quot;parameters.bsn&quot;</span>),</span>
<span id="cb525-43"><a href="model-verification-swatdoctr.html#cb525-43" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">&quot;   &quot;</span>,</span>
<span id="cb525-44"><a href="model-verification-swatdoctr.html#cb525-44" tabindex="-1"></a>  <span class="at">row.names =</span> F,</span>
<span id="cb525-45"><a href="model-verification-swatdoctr.html#cb525-45" tabindex="-1"></a>  <span class="at">col.names =</span> F,</span>
<span id="cb525-46"><a href="model-verification-swatdoctr.html#cb525-46" tabindex="-1"></a>  <span class="at">append =</span> F, </span>
<span id="cb525-47"><a href="model-verification-swatdoctr.html#cb525-47" tabindex="-1"></a>  <span class="at">quote =</span> F</span>
<span id="cb525-48"><a href="model-verification-swatdoctr.html#cb525-48" tabindex="-1"></a>)</span>
<span id="cb525-49"><a href="model-verification-swatdoctr.html#cb525-49" tabindex="-1"></a><span class="do">### Writing file contents</span></span>
<span id="cb525-50"><a href="model-verification-swatdoctr.html#cb525-50" tabindex="-1"></a><span class="fu">write.table</span>(</span>
<span id="cb525-51"><a href="model-verification-swatdoctr.html#cb525-51" tabindex="-1"></a>  codes_bsn,</span>
<span id="cb525-52"><a href="model-verification-swatdoctr.html#cb525-52" tabindex="-1"></a>  <span class="at">file =</span> <span class="fu">paste0</span>(write_path, <span class="st">&quot;codes.bsn&quot;</span>),</span>
<span id="cb525-53"><a href="model-verification-swatdoctr.html#cb525-53" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">&quot;   &quot;</span>,</span>
<span id="cb525-54"><a href="model-verification-swatdoctr.html#cb525-54" tabindex="-1"></a>  <span class="at">row.names =</span> F,</span>
<span id="cb525-55"><a href="model-verification-swatdoctr.html#cb525-55" tabindex="-1"></a>  <span class="at">col.names =</span> T,</span>
<span id="cb525-56"><a href="model-verification-swatdoctr.html#cb525-56" tabindex="-1"></a>  <span class="at">append =</span> T,</span>
<span id="cb525-57"><a href="model-verification-swatdoctr.html#cb525-57" tabindex="-1"></a>  <span class="at">quote =</span> F</span>
<span id="cb525-58"><a href="model-verification-swatdoctr.html#cb525-58" tabindex="-1"></a>)</span>
<span id="cb525-59"><a href="model-verification-swatdoctr.html#cb525-59" tabindex="-1"></a><span class="fu">write.table</span>(</span>
<span id="cb525-60"><a href="model-verification-swatdoctr.html#cb525-60" tabindex="-1"></a>  parameters_bsn,</span>
<span id="cb525-61"><a href="model-verification-swatdoctr.html#cb525-61" tabindex="-1"></a>  <span class="fu">paste0</span>(write_path, <span class="st">&quot;parameters.bsn&quot;</span>),</span>
<span id="cb525-62"><a href="model-verification-swatdoctr.html#cb525-62" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">&quot;   &quot;</span>,</span>
<span id="cb525-63"><a href="model-verification-swatdoctr.html#cb525-63" tabindex="-1"></a>  <span class="at">row.names =</span> F,</span>
<span id="cb525-64"><a href="model-verification-swatdoctr.html#cb525-64" tabindex="-1"></a>  <span class="at">col.names =</span> T,</span>
<span id="cb525-65"><a href="model-verification-swatdoctr.html#cb525-65" tabindex="-1"></a>  <span class="at">append =</span> T,</span>
<span id="cb525-66"><a href="model-verification-swatdoctr.html#cb525-66" tabindex="-1"></a>  <span class="at">quote =</span> F</span>
<span id="cb525-67"><a href="model-verification-swatdoctr.html#cb525-67" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="climate-variables-1" class="section level3 hasAnchor" number="12.1.2">
<h3><span class="header-section-number">12.1.2</span> Climate variables<a href="model-verification-swatdoctr.html#climate-variables-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Over or underestimated PET can indicate errors in the temperature
input files (and if provided in the solar radiation, relative
humidity and wind speed inputs).</p></li>
<li><p><code>SWATdoctR</code> provides the function <code>plot_climate_annual()</code> to analyse
the annual simulated basin averages of climate variables.</p></li>
</ul>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="model-verification-swatdoctr.html#cb526-1" tabindex="-1"></a>fig1 <span class="ot">&lt;-</span> <span class="fu">plot_climate_annual</span>(sim_nostress)</span>
<span id="cb526-2"><a href="model-verification-swatdoctr.html#cb526-2" tabindex="-1"></a><span class="fu">plot</span>(fig1)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:docplotclimate"></span>
<img src="_main_files/figure-html/docplotclimate-1.png" alt="Climate plot of CS10 generated by SWATDoctR" width="796.8" />
<p class="caption">
Figure 12.3: Climate plot of CS10 generated by SWATDoctR
</p>
</div>
<ul>
<li>The <strong>first panel</strong> shows ET fractions. Current version of SWAT+
often has implausible ET fractions!</li>
</ul>
<blockquote>
<p>Are these values plausible?</p>
</blockquote>
<p>No – tracking in issue
<a href="https://gitlab.nibio.no/moritzshore/swat-cs10/-/issues/62">#62</a></p>
<ul>
<li>The <strong>second panel</strong> shows the precipitation fractions rainfall
(<code>rainfall</code>) and snowfall (<code>snofall</code>).</li>
</ul>
<blockquote>
<p>Are these values plausible?</p>
</blockquote>
<p>Yes. Resolved in issue
<a href="https://gitlab.nibio.no/moritzshore/swat-cs10/-/issues/43">#43</a></p>
<ul>
<li>The <strong>third panel</strong> shows the annual temperature values.</li>
</ul>
<blockquote>
<p>Are these values plausible?</p>
</blockquote>
<p><a href="https://klimaservicesenter.no/kss/klimaprofiler/oslo-og-akershus">Yes</a>.</p>
<ul>
<li>The <strong>fourth panel</strong> shows the relative humidity values.</li>
</ul>
<blockquote>
<p>Are these values plausible?</p>
</blockquote>
<p>Answer: resolved in issue
<a href="https://gitlab.nibio.no/moritzshore/swat-cs10/-/issues/42">#42</a>) but
are they plausible? Csilla</p>
<ul>
<li>The <strong>fifth panel</strong> shows wind speed.</li>
</ul>
<blockquote>
<p>Are these values plausible?</p>
</blockquote>
<p>Resolved in
<a href="https://gitlab.nibio.no/moritzshore/swat-cs10/-/issues/42">#42</a>, Csilla
plausible?</p>
<ul>
<li>The <strong>sixth panel</strong> shows the annual sums of solar radiation. A
comparison to literature values of annual solar radiation sums for
the region can indicate issues in this input.</li>
</ul>
<blockquote>
<p>Are these values plausible?</p>
</blockquote>
<p>Yes, values for the Oslo area seem to be around <a href="https://re.jrc.ec.europa.eu/pvg_tools/en/">4000
MJ</a> – Csilla do you agree?</p>
</div>
<div id="snowfall-and-snowmelt" class="section level3 hasAnchor" number="12.1.3">
<h3><span class="header-section-number">12.1.3</span> Snowfall and Snowmelt<a href="model-verification-swatdoctr.html#snowfall-and-snowmelt" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The analysis of mean monthly precipitation (output variable
<code>precip</code>), snowfall (output variable <code>snofall</code>) and snow melt
(output variable <code>snomlt</code>) sums and their comparison with region
specific information (or in the best case observations) provides
insight in seasonal dynamics of the precipitation input.
Particularly in snow impacted catchments a first verification of
snowfall is valuable to see whether precipitation in solid form is
simulated, a snow storage can build up and cause increased spring
runoff through snow melt. The hydrological cycle of some catchments
may be dominated by spring flood events which must be reflected by
the simulated processes. Any observed implausibility in such
analysis can indicate issues in the weather inputs or require to pay
attention in the calibration of model parameters which control the
simulation of snow processes (<code>snofall_tmp</code>, <code>snomelt_tmp</code>,
<code>snomelt_lag</code>).</li>
</ul>
<blockquote>
<p>CS10, a Boreal catchment, is impacted by snow melt – this is relevant
to the verification</p>
</blockquote>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="model-verification-swatdoctr.html#cb527-1" tabindex="-1"></a><span class="fu">plot_monthly_snow</span>(<span class="at">sim_verify =</span> sim_nostress)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:docplotmonthlysnow"></span>
<img src="_main_files/figure-html/docplotmonthlysnow-1.png" alt="Precipitation and Snowmelt on a monthly average basis, as generated by SWATDoctR" width="672" />
<p class="caption">
Figure 12.4: Precipitation and Snowmelt on a monthly average basis, as generated by SWATDoctR
</p>
</div>
<blockquote>
<p>This has been resolved in issue #43.
(<a href="https://gitlab.nibio.no/moritzshore/swat-cs10/-/issues/43">link</a>).
Are these values plausible csilla?</p>
</blockquote>
<ul>
<li>In situations where not all required climate inputs are available
which are necessary to estimate PET with PM method the estimates
will be more uncertain and annual PET sums may differ to regional
values. Then the use of a simpler method for the calculation of PET
can be a valid solution.</li>
</ul>
<blockquote>
<p>We do not need a simpler method since we have the required data</p>
</blockquote>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="model-verification-swatdoctr.html#cb528-1" tabindex="-1"></a><span class="fu">plot_waterbalance</span>(sim_nostress)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-115-1.png" width="672" /></p>
<hr />
</div>
</div>
<div id="management-operations" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Management operations<a href="model-verification-swatdoctr.html#management-operations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Development of management tables is complicated and complex – and thus
error prone. Mistakes in this area do not produce any errors or warnings
making them easy to miss.</p>
<blockquote>
<p>All operations which are triggered in a SWAT+ simulation run are
written into the file ‘mgt_out.txt’</p>
</blockquote>
<p>To verify the operations, we are going to compare scheduled and
simulated operations for specific HRUs by random sampling.</p>
<p>For this, we need a SWAT+ run with management outputs. If we have
already run this code, we do not need to run it again, and can just load
it in:</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="model-verification-swatdoctr.html#cb529-1" tabindex="-1"></a>run_name <span class="ot">=</span> <span class="st">&quot;spacing800all&quot;</span></span>
<span id="cb529-2"><a href="model-verification-swatdoctr.html#cb529-2" tabindex="-1"></a></span>
<span id="cb529-3"><a href="model-verification-swatdoctr.html#cb529-3" tabindex="-1"></a>veri_mgt <span class="ot">&lt;-</span></span>
<span id="cb529-4"><a href="model-verification-swatdoctr.html#cb529-4" tabindex="-1"></a>  <span class="fu">readRDS</span>(<span class="fu">paste0</span>(<span class="st">&quot;model_data/swat_doctR/verification_runs/&quot;</span>, run_name, <span class="st">&quot;.rds&quot;</span>))</span></code></pre></div>
<p>Skip this code block, unless you want to re-run SWAT+</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="model-verification-swatdoctr.html#cb530-1" tabindex="-1"></a>veri_mgt <span class="ot">&lt;-</span></span>
<span id="cb530-2"><a href="model-verification-swatdoctr.html#cb530-2" tabindex="-1"></a>  <span class="fu">run_swat_verification</span>(</span>
<span id="cb530-3"><a href="model-verification-swatdoctr.html#cb530-3" tabindex="-1"></a>    <span class="at">project_path =</span> doctr_path,</span>
<span id="cb530-4"><a href="model-verification-swatdoctr.html#cb530-4" tabindex="-1"></a>    <span class="at">keep_folder =</span> T</span>
<span id="cb530-5"><a href="model-verification-swatdoctr.html#cb530-5" tabindex="-1"></a>  )</span>
<span id="cb530-6"><a href="model-verification-swatdoctr.html#cb530-6" tabindex="-1"></a></span>
<span id="cb530-7"><a href="model-verification-swatdoctr.html#cb530-7" tabindex="-1"></a>run_name <span class="ot">=</span> <span class="st">&quot;spacing800all&quot;</span></span>
<span id="cb530-8"><a href="model-verification-swatdoctr.html#cb530-8" tabindex="-1"></a><span class="fu">saveRDS</span>(veri_mgt,</span>
<span id="cb530-9"><a href="model-verification-swatdoctr.html#cb530-9" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="st">&quot;model_data/swat_doctR/verification_runs/&quot;</span>,</span>
<span id="cb530-10"><a href="model-verification-swatdoctr.html#cb530-10" tabindex="-1"></a>               run_name,</span>
<span id="cb530-11"><a href="model-verification-swatdoctr.html#cb530-11" tabindex="-1"></a>               <span class="st">&quot;.rds&quot;</span>))</span></code></pre></div>
<p>From the Protocol:</p>
<p>“The function <code>report_mgt()</code> generates an overview report where the
scheduled and triggered operations are matched and compared for each
management schedule that was implemented in the simulations. The
function prepares the scheduled management operations that were written
in the input file ‘management.sch’ in tabular form and randomly samples
one HRU for each defined schedule from the triggered management
operations (from the output file ‘mgt_out.txt’). The comparison is only
done for operations that were defined with a fixed date in the
management schedule and operations which are triggered by decision
tables will be excluded.”</p>
<p>“Applying the function <code>report_mgt()</code> for the model verification
simulation outputs returns a table with an overview of the operations
which were scheduled but not triggered or operations where ‘op_data1’
differs in the scheduled and triggered operations.”</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="model-verification-swatdoctr.html#cb531-1" tabindex="-1"></a>mgt_report <span class="ot">&lt;-</span> <span class="fu">report_mgt</span>(veri_mgt, <span class="at">write_report =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Seems like there are no issues. I am not sure if this is a good or bad
thing :D.</p>
<p>“The <code>report_mgt()</code> function is a good starting point to explore the
triggered management. But this analysis can be error prone. Still the
safest way to analyse the triggered and the scheduled managements is to
compare the input and output tables. <code>SWATdoctR</code> provides the function
<code>print_triggered_mgt()</code> to print the triggered managements for
individual HRUs. For selecting HRUs e.g. with a specific management the
helper function <code>get_hru_id_by_attribute()</code> can be useful. This table
can be visually compared with the management input table
(‘management.sch’)”</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="model-verification-swatdoctr.html#cb532-1" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">print_triggered_mgt</span>(<span class="at">sim_verify =</span> veri_mgt, <span class="at">hru_id =</span> <span class="dv">92</span>)</span>
<span id="cb532-2"><a href="model-verification-swatdoctr.html#cb532-2" tabindex="-1"></a></span>
<span id="cb532-3"><a href="model-verification-swatdoctr.html#cb532-3" tabindex="-1"></a><span class="fu">datatable</span>(table)</span></code></pre></div>
<p>To see the operations of a specific management schedule:</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="model-verification-swatdoctr.html#cb533-1" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">get_hru_id_by_attribute</span>(veri_mgt, <span class="at">mgt =</span> <span class="st">&quot;a_001f_1_drn_mgt_1731_1&quot;</span>)</span>
<span id="cb533-2"><a href="model-verification-swatdoctr.html#cb533-2" tabindex="-1"></a></span>
<span id="cb533-3"><a href="model-verification-swatdoctr.html#cb533-3" tabindex="-1"></a>tables <span class="ot">&lt;-</span> <span class="fu">print_triggered_mgt</span>(<span class="at">sim_verify =</span> veri_mgt, <span class="at">hru_id =</span> test<span class="sc">$</span>id[<span class="dv">1</span>])</span>
<span id="cb533-4"><a href="model-verification-swatdoctr.html#cb533-4" tabindex="-1"></a></span>
<span id="cb533-5"><a href="model-verification-swatdoctr.html#cb533-5" tabindex="-1"></a><span class="fu">datatable</span>(tables)</span></code></pre></div>
<p>“Operations which are missing in the simulated management schedules must
be checked in the ‘management.sch’ input file. By answering the
following questions for the scheduled management operations their proper
implementation in the model setup can be verified:”</p>
<ol style="list-style-type: decimal">
<li>Are the date sequences in the scheduled operations correct and in a
right order (mistakes in assigned month and day values)?</li>
</ol>
<blockquote>
<p>Answer:</p>
</blockquote>
<ol start="2" style="list-style-type: decimal">
<li>Does the variable <code>op_data1</code> point to the correct entry in the
respective input data file? Does the label exist in the input file?
E.g. does defined <code>op_data1</code> exist in ‘tillage.til’ for tillage
operations, or does defined <code>op_data1</code> exist in ‘plant.plt’ for
plant operations</li>
</ol>
<blockquote>
<p>Answer:</p>
</blockquote>
<ol start="3" style="list-style-type: decimal">
<li>Does the variable <code>op_data2</code> point to the correct entry in the
respective operations file (‘.ops’)? E.g. does harvest operation
defined with <code>op_data2</code> exist in ‘harv.ops’.</li>
</ol>
<blockquote>
<p>Answer:</p>
</blockquote>
</div>
<div id="unconstrained-plant-growth" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Unconstrained plant growth<a href="model-verification-swatdoctr.html#unconstrained-plant-growth" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This will be a two-tiered approach (with and without stress factors)</p>
<p>“The function <code>plot_variable_at_harvkill()</code> function summarises the
state of variables at the time of harvest/kill operations for all crops
in a model setup and thus provides a general overview”</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="model-verification-swatdoctr.html#cb534-1" tabindex="-1"></a><span class="fu">plot_variable_at_harvkill</span>(veri_mgt, <span class="st">&quot;yield&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="model-verification-swatdoctr.html#cb535-1" tabindex="-1"></a><span class="fu">plot_variable_at_harvkill</span>(veri_mgt, <span class="st">&quot;phu&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="model-verification-swatdoctr.html#cb536-1" tabindex="-1"></a><span class="fu">plot_variable_at_harvkill</span>(veri_mgt, <span class="st">&quot;bioms&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="model-verification-swatdoctr.html#cb537-1" tabindex="-1"></a><span class="fu">plot_variable_at_harvkill</span>(veri_mgt, <span class="st">&quot;stress&quot;</span>)</span></code></pre></div>
<p>“the function <code>plot_hru_pw_day()</code> allows detailed analyses of the daily
time series of HRU related variables, which then can only be performed
for a few HRUs of a model setup.”</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="model-verification-swatdoctr.html#cb538-1" tabindex="-1"></a><span class="fu">plot_hru_pw_day</span>(veri_mgt, <span class="dv">13</span>, <span class="at">var =</span>  <span class="st">&quot;lai&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="model-verification-swatdoctr.html#cb539-1" tabindex="-1"></a><span class="fu">plot_qtile</span>(veri_mgt)</span></code></pre></div>
<p>update_landuse_labels currently has its issues. See
<a href="https://git.ufz.de/schuerz/swatdoctr/-/issues/3">here</a></p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="model-verification-swatdoctr.html#cb540-1" tabindex="-1"></a><span class="fu">update_landuse_labels</span>(doctr_path)</span></code></pre></div>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="model-verification-swatdoctr.html#cb541-1" tabindex="-1"></a>hru_wb_check <span class="ot">&lt;-</span> <span class="fu">check_hru_waterbalance</span>(</span>
<span id="cb541-2"><a href="model-verification-swatdoctr.html#cb541-2" tabindex="-1"></a>  veri_mgt,</span>
<span id="cb541-3"><a href="model-verification-swatdoctr.html#cb541-3" tabindex="-1"></a>  <span class="at">check =</span> <span class="fu">c</span>(<span class="st">&quot;precip&quot;</span>, <span class="st">&quot;et&quot;</span>, <span class="st">&quot;runoff&quot;</span>, <span class="st">&quot;sw&quot;</span>, <span class="st">&quot;cn&quot;</span>),</span>
<span id="cb541-4"><a href="model-verification-swatdoctr.html#cb541-4" tabindex="-1"></a>  <span class="at">ignore_lum =</span> <span class="cn">NULL</span>,</span>
<span id="cb541-5"><a href="model-verification-swatdoctr.html#cb541-5" tabindex="-1"></a>  <span class="at">add_values =</span> <span class="cn">TRUE</span></span>
<span id="cb541-6"><a href="model-verification-swatdoctr.html#cb541-6" tabindex="-1"></a>)</span>
<span id="cb541-7"><a href="model-verification-swatdoctr.html#cb541-7" tabindex="-1"></a></span>
<span id="cb541-8"><a href="model-verification-swatdoctr.html#cb541-8" tabindex="-1"></a><span class="fu">datatable</span>(hru_wb_check)</span></code></pre></div>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="model-verification-swatdoctr.html#cb542-1" tabindex="-1"></a><span class="fu">plot_basin_var</span>(veri_mgt, <span class="st">&quot;qtile&quot;</span>, <span class="at">period =</span> <span class="st">&quot;day&quot;</span>, <span class="at">fn_summarize =</span> <span class="st">&quot;mean&quot;</span>)</span></code></pre></div>
<p>plot_waterbalance currently broken, see
<a href="https://git.ufz.de/schuerz/swatdoctr/-/issues/4">here</a></p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="model-verification-swatdoctr.html#cb543-1" tabindex="-1"></a><span class="fu">plot_waterbalance</span>(veri_mgt)</span></code></pre></div>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="model-verification-swatdoctr.html#cb544-1" tabindex="-1"></a>qtile_aa_dt <span class="ot">&lt;-</span> <span class="fu">print_avannual_qtile</span>(veri_mgt)</span>
<span id="cb544-2"><a href="model-verification-swatdoctr.html#cb544-2" tabindex="-1"></a></span>
<span id="cb544-3"><a href="model-verification-swatdoctr.html#cb544-3" tabindex="-1"></a><span class="fu">datatable</span>(qtile_aa_dt)</span></code></pre></div>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="model-verification-swatdoctr.html#cb545-1" tabindex="-1"></a><span class="fu">plot_ps</span>(veri_mgt)</span></code></pre></div>
<p><strong>Related Minor Issues</strong></p>
<p>Getting drainage yet? -
<a href="https://gitlab.nibio.no/moritzshore/swat-cs10/-/issues/16">#16</a></p>
<p>Atmodep not read -
<a href="https://gitlab.nibio.no/moritzshore/swat-cs10/-/issues/44">#44</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="management-swatfarmr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="soft-calibration.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://gitlab.nibio.no/moritzshore/swat-cs10/-/edit/main/12-doctR.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://gitlab.nibio.no/moritzshore/swat-cs10/blob/main/12-doctR.Rmd",
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
